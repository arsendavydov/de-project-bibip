Убрал повторяющиеся участки кода, сделав дополнительные вспомогательные методы